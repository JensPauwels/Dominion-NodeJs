<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Node Pratice</title>
  </head>

  <body>

    <section style="border:1px solid black;min-height:100px;" id="messasges">

    </section>

    <form action="#" method="post" id="sendMessage">
      <input type="text" id="username" placeholder="username">
      <input type="text" id="message" placeholder="message">
      <input type="submit" placeholder="verstuur!">
    </form>







    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script>
      const socket = io.connect();

      const addMesasge = (data) => {
        console.log(data);
        $('#messasges').append(`${data.username}: ${data.message}`);
      };

      socket.on('newMessage', (data) => {
        addMesasge(data);
      });

      const addMessage = (e) => {
        e.preventDefault();
        const data = {
          username: $('#username').val(),
          message: $('#message').val()
        }


        socket.emit('sendMessage', data);
        addMesasge(data);
      };

      $(() => {
        $('#sendMessage').on('submit', addMessage);
      });

    </script>

  </body>

</html>
